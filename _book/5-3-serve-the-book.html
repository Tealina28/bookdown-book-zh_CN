<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="5.3 Serve the book | Bookdown: 使用 R Markdown 创作书籍和技术文档" />
<meta property="og:type" content="book" />
<meta property="og:url" content="https://bookdown.org/yihui/bookdown/" />
<meta property="og:image" content="https://bookdown.org/yihui/bookdown//images/cover.jpg" />
<meta property="og:description" content="这是一本使用 R Markdown 编写书籍的指南，包括如何生成图片和表格，以及如何在 R Markdown 中插入交叉引用、引文、HTML 组件和 Shiny 应用。本书能够导出为 HTML、PDF 和电子书（例如 EPUB）。本书的风格是可以定制的。你可以在 RStudio IDE 或其它编辑器中轻松地编辑和预览本书，并在你想要的任何地方（例如 bookdown.org）托管本书。" />
<meta name="github-repo" content="rstudio/bookdown" />

<meta name="author" content="谢益辉" />

<meta name="date" content="2021-07-12" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="这是一本使用 R Markdown 编写书籍的指南，包括如何生成图片和表格，以及如何在 R Markdown 中插入交叉引用、引文、HTML 组件和 Shiny 应用。本书能够导出为 HTML、PDF 和电子书（例如 EPUB）。本书的风格是可以定制的。你可以在 RStudio IDE 或其它编辑器中轻松地编辑和预览本书，并在你想要的任何地方（例如 bookdown.org）托管本书。">

<title>5.3 Serve the book | Bookdown: 使用 R Markdown 创作书籍和技术文档</title>

<script src="libs/header-attrs/header-attrs.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap/js/bootstrap.min.js"></script>
<script src="libs/bootstrap/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation/tabsets.js"></script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding/datatables.js"></script>
<link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li><a href="index.html#翻译与排版说明">翻译与排版说明</a>
<ul>
<li><a href="翻译说明.html#翻译说明">翻译说明</a></li>
<li><a href="排版说明.html#排版说明">排版说明</a></li>
<li><a href="翻译进度.html#翻译进度">翻译进度</a></li>
</ul></li>
<li><a href="前言.html#前言">前言</a>
<ul>
<li><a href="为什么要阅读这本书.html#为什么要阅读这本书">为什么要阅读这本书</a></li>
<li><a href="本书的结构.html#本书的结构">本书的结构</a></li>
<li><a href="软件信息与一些约定.html#软件信息与一些约定">软件信息与一些约定</a></li>
<li><a href="致谢.html#致谢">致谢</a></li>
</ul></li>
<li><a href="关于作者.html#关于作者">关于作者</a></li>
<li><a href="1-introduction.html#introduction"><span class="toc-section-number">1</span> 简介</a>
<ul>
<li><a href="1-1-开发动机.html#开发动机"><span class="toc-section-number">1.1</span> 开发动机</a></li>
<li><a href="1-2-开始.html#开始"><span class="toc-section-number">1.2</span> 开始</a></li>
<li><a href="1-3-usage.html#usage"><span class="toc-section-number">1.3</span> 使用</a></li>
<li><a href="1-4-new-session.html#new-session"><span class="toc-section-number">1.4</span> 两种呈现方法</a></li>
<li><a href="1-5-一些提示.html#一些提示"><span class="toc-section-number">1.5</span> 一些提示</a></li>
</ul></li>
<li><a href="2-components.html#components"><span class="toc-section-number">2</span> Components</a>
<ul>
<li><a href="2-1-markdown-syntax.html#markdown-syntax"><span class="toc-section-number">2.1</span> Markdown syntax</a>
<ul>
<li><a href="2-1-markdown-syntax.html#inline-formatting"><span class="toc-section-number">2.1.1</span> Inline formatting</a></li>
<li><a href="2-1-markdown-syntax.html#block-level-elements"><span class="toc-section-number">2.1.2</span> Block-level elements</a></li>
<li><a href="2-1-markdown-syntax.html#math-expressions"><span class="toc-section-number">2.1.3</span> Math expressions</a></li>
</ul></li>
<li><a href="2-2-markdown-extensions-by-bookdown.html#markdown-extensions-by-bookdown"><span class="toc-section-number">2.2</span> Markdown extensions by bookdown</a>
<ul>
<li><a href="2-2-markdown-extensions-by-bookdown.html#equations"><span class="toc-section-number">2.2.1</span> Number and reference equations</a></li>
<li><a href="2-2-markdown-extensions-by-bookdown.html#theorems"><span class="toc-section-number">2.2.2</span> Theorems and proofs</a></li>
<li><a href="2-2-markdown-extensions-by-bookdown.html#special-headers"><span class="toc-section-number">2.2.3</span> Special headers</a></li>
<li><a href="2-2-markdown-extensions-by-bookdown.html#text-references"><span class="toc-section-number">2.2.4</span> Text references</a></li>
</ul></li>
<li><a href="2-3-r-code.html#r-code"><span class="toc-section-number">2.3</span> R code</a></li>
<li><a href="2-4-figures.html#figures"><span class="toc-section-number">2.4</span> Figures</a></li>
<li><a href="2-5-tables.html#tables"><span class="toc-section-number">2.5</span> Tables</a></li>
<li><a href="2-6-cross-references.html#cross-references"><span class="toc-section-number">2.6</span> Cross-references</a></li>
<li><a href="2-7-custom-blocks.html#custom-blocks"><span class="toc-section-number">2.7</span> Custom blocks</a></li>
<li><a href="2-8-citations.html#citations"><span class="toc-section-number">2.8</span> Citations</a></li>
<li><a href="2-9-latex-index.html#latex-index"><span class="toc-section-number">2.9</span> Index</a></li>
<li><a href="2-10-html-widgets.html#html-widgets"><span class="toc-section-number">2.10</span> HTML widgets</a></li>
<li><a href="2-11-web-pages-and-shiny-apps.html#web-pages-and-shiny-apps"><span class="toc-section-number">2.11</span> Web pages and Shiny apps</a></li>
</ul></li>
<li><a href="3-output-formats.html#output-formats"><span class="toc-section-number">3</span> Output Formats</a>
<ul>
<li><a href="3-1-html.html#html"><span class="toc-section-number">3.1</span> HTML</a>
<ul>
<li><a href="3-1-html.html#gitbook-style"><span class="toc-section-number">3.1.1</span> GitBook style</a></li>
<li><a href="3-1-html.html#bootstrap-style"><span class="toc-section-number">3.1.2</span> Bootstrap style</a></li>
<li><a href="3-1-html.html#tufte-style"><span class="toc-section-number">3.1.3</span> Tufte style</a></li>
</ul></li>
<li><a href="3-2-latexpdf.html#latexpdf"><span class="toc-section-number">3.2</span> LaTeX/PDF</a></li>
<li><a href="3-3-e-books.html#e-books"><span class="toc-section-number">3.3</span> E-Books</a>
<ul>
<li><a href="3-3-e-books.html#epub"><span class="toc-section-number">3.3.1</span> EPUB</a></li>
<li><a href="3-3-e-books.html#mobi"><span class="toc-section-number">3.3.2</span> MOBI</a></li>
</ul></li>
<li><a href="3-4-a-single-document.html#a-single-document"><span class="toc-section-number">3.4</span> A single document</a></li>
</ul></li>
<li><a href="4-customization.html#customization"><span class="toc-section-number">4</span> Customization</a>
<ul>
<li><a href="4-1-yaml-options.html#yaml-options"><span class="toc-section-number">4.1</span> YAML options</a></li>
<li><a href="4-2-theming.html#theming"><span class="toc-section-number">4.2</span> Theming</a></li>
<li><a href="4-3-templates.html#templates"><span class="toc-section-number">4.3</span> Templates</a></li>
<li><a href="4-4-configuration.html#configuration"><span class="toc-section-number">4.4</span> Configuration</a></li>
<li><a href="4-5-internationalization.html#internationalization"><span class="toc-section-number">4.5</span> Internationalization</a></li>
</ul></li>
<li><a href="5-editing.html#editing"><span class="toc-section-number">5</span> Editing</a>
<ul>
<li><a href="5-1-build-the-book.html#build-the-book"><span class="toc-section-number">5.1</span> Build the book</a></li>
<li><a href="5-2-preview-a-chapter.html#preview-a-chapter"><span class="toc-section-number">5.2</span> Preview a chapter</a></li>
<li><a href="5-3-serve-the-book.html#serve-the-book"><span class="toc-section-number">5.3</span> Serve the book</a></li>
<li><a href="5-4-rstudio-ide.html#rstudio-ide"><span class="toc-section-number">5.4</span> RStudio IDE</a></li>
<li><a href="5-5-collaboration.html#collaboration"><span class="toc-section-number">5.5</span> Collaboration</a></li>
</ul></li>
<li><a href="6-发布与出版.html#发布与出版"><span class="toc-section-number">6</span> 发布与出版</a>
<ul>
<li><a href="6-1-rstudio-connect.html#rstudio-connect"><span class="toc-section-number">6.1</span> RStudio Connect</a></li>
<li><a href="6-2-github.html#github"><span class="toc-section-number">6.2</span> GitHub</a></li>
<li><a href="6-3-出版商.html#出版商"><span class="toc-section-number">6.3</span> 出版商</a></li>
</ul></li>
<li class="appendix"><span><b>附录</b></span></li>
<li><a href="A-软件工具.html#软件工具"><span class="toc-section-number">A</span> 软件工具</a>
<ul>
<li><a href="A-1-r-和-r-软件包.html#r-和-r-软件包"><span class="toc-section-number">A.1</span> R 和 R 软件包</a></li>
<li><a href="A-2-pandoc.html#pandoc"><span class="toc-section-number">A.2</span> Pandoc</a></li>
<li><a href="A-3-latex.html#latex"><span class="toc-section-number">A.3</span> LaTeX</a></li>
</ul></li>
<li><a href="B-软件使用.html#软件使用"><span class="toc-section-number">B</span> 软件使用</a>
<ul>
<li><a href="B-1-knitr.html#knitr"><span class="toc-section-number">B.1</span> knitr</a></li>
<li><a href="B-2-r-markdown.html#r-markdown"><span class="toc-section-number">B.2</span> R Markdown</a></li>
</ul></li>
<li><a href="C-常见问题.html#常见问题"><span class="toc-section-number">C</span> 常见问题</a></li>
<li><a href="参考文献.html#参考文献">参考文献</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="serve-the-book" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Serve the book</h2>
<p>Instead of running <code>render_book()</code> or <code>preview_chapter()</code> over and over again, you can actually live preview the book in the web browser, and the only thing you need to do is save the Rmd file. The function <code>serve_book()</code> in <strong>bookdown</strong> can start a local web server to serve the HTML output based on the <strong>servr</strong> package <span class="citation">(<a href="#ref-R-servr" role="doc-biblioref">Xie 2020</a>)</span>.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="5-3-serve-the-book.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">serve_book</span>(<span class="at">dir =</span> <span class="st">&quot;.&quot;</span>, <span class="at">output_dir =</span> <span class="st">&quot;_book&quot;</span>,</span>
<span id="cb113-2"><a href="5-3-serve-the-book.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">preview =</span> <span class="cn">TRUE</span>, <span class="at">in_session =</span> <span class="cn">TRUE</span>, <span class="at">quiet =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-3"><a href="5-3-serve-the-book.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  ...)</span></code></pre></div>
<p>You pass the root directory of the book to the <code>dir</code> argument, and this function will start a local web server so you can view the book output using the server. The default URL to access the book output is <code>http://127.0.0.1:4321</code>. If you run this function in an interactive R session, this URL will be automatically opened in your web browser. If you are in the RStudio IDE, the RStudio Viewer will be used as the default web browser, so you will be able to write the Rmd source files and preview the output in the same environment (e.g., source on the left and output on the right).</p>
<p>The server will listen to changes in the book root directory: whenever you modify any files in the book directory, <code>serve_book()</code> can detect the changes, recompile the Rmd files, and refresh the web browser automatically. If the modified files do not include Rmd files, it just refreshes the browser (e.g., if you only updated a certain CSS file). This means once the server is launched, all you have to do next is simply write the book and save the files. Compilation and preview will take place automatically as you save files.</p>
<p>If it does not really take too much time to recompile the whole book, you may set the argument <code>preview = FALSE</code>, so that every time you update the book, the whole book is recompiled, otherwise only the modified chapters are recompiled via <code>preview_chapter()</code>.</p>
<p>The arguments in <code>...</code> are passed to <code>servr::httw()</code>, and please refer to its help page to see all possible options, such as <code>daemon</code> and <code>port</code>. There are pros and cons of using <code>in_session = TRUE</code> or <code>FALSE</code>:</p>
<ul>
<li>For <code>in_session = TRUE</code>, you will have access to all objects created in the book in the current R session: if you use a daemonized server (via the argument <code>daemon = TRUE</code>), you can check the objects at any time when the current R session is not busy; otherwise you will have to stop the server before you can check the objects. This can be useful when you need to interactively explore the R objects in the book. The downside of <code>in_session = TRUE</code> is that the output may be different with the book compiled from a fresh R session, because the state of the current R session may not be clean.</li>
<li>For <code>in_session = FALSE</code>, you do not have access to objects in the book from the current R session, but the output is more likely to be reproducible since everything is created from new R sessions. Since this function is only for previewing purposes, the cleanness of the R session may not be a big concern.</li>
</ul>
<p>You may choose <code>in_session = TRUE</code> or <code>FALSE</code> depending on your specific use cases. Eventually, you should run <code>render_book()</code> from a fresh R session to generate a reliable copy of the book output.</p>
</div>
<h3>参考文献</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-servr" class="csl-entry">
———. 2020. <em>Servr: A Simple HTTP Server to Serve Static Files or Dynamic Documents</em>. <a href="https://github.com/yihui/servr">https://github.com/yihui/servr</a>.
</div>
</div>
<p style="text-align: center;">
<a href="5-2-preview-a-chapter.html"><button class="btn btn-default">Previous</button></a>
<a href="5-4-rstudio-ide.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
